2023-07-01 11:33:31.269878: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
Traceback (most recent call last):
  File "C:\Users\XYZ\Downloads\Bug Reproducibility\Bugs\022\main.py", line 40, in <module>
    apply_gradients(optimizer, grads, model.trainable_variables)
  File "C:\Users\XYZ\Downloads\Bug Reproducibility\Bugs\022\main.py", line 15, in apply_gradients
    optimizer.apply_gradients(zip(grads, model_vars))
  File "C:\Users\XYZ\Downloads\Bug Reproducibility\venv\lib\site-packages\keras\optimizers\optimizer_experimental\optimizer.py", line 1139, in apply_gradients
    grads_and_vars = self.aggregate_gradients(grads_and_vars)
  File "C:\Users\XYZ\Downloads\Bug Reproducibility\venv\lib\site-packages\keras\optimizers\optimizer_experimental\optimizer.py", line 1105, in aggregate_gradients
    return optimizer_utils.all_reduce_sum_gradients(grads_and_vars)
  File "C:\Users\XYZ\Downloads\Bug Reproducibility\venv\lib\site-packages\keras\optimizers\optimizer_v2\utils.py", line 33, in all_reduce_sum_gradients
    filtered_grads_and_vars = filter_empty_gradients(grads_and_vars)
  File "C:\Users\XYZ\Downloads\Bug Reproducibility\venv\lib\site-packages\keras\optimizers\optimizer_v2\utils.py", line 77, in filter_empty_gradients
    raise ValueError(
ValueError: No gradients provided for any variable: (['dense/kernel:0', 'dense/bias:0', 'dense_1/kernel:0', 'dense_1/bias:0', 'dense_2/kernel:0', 'dense_2/bias:0'],). Provided `grads_and_vars` is ((None, <tf.Variable 'dense/kernel:0' shape=(1, 64) dtype=float32, numpy=
array([[ 0.05271447,  0.24639046, -0.12337501,  0.24857861,  0.19662684,
        -0.06624211, -0.03470975, -0.2499676 ,  0.11081007,  0.08856422,
        -0.04095313,  0.15179354, -0.01954502, -0.02270481, -0.29888943,
        -0.14090471, -0.09021695,  0.09354129,  0.27219534,  0.02524653,
         0.01065734, -0.01052099, -0.26871163, -0.12108037,  0.19098836,
        -0.2031528 , -0.18536712, -0.2719655 , -0.23788023,  0.2601332 ,
         0.27953845, -0.20470831, -0.03867137,  0.00200376, -0.1167493 ,
         0.06644002, -0.11618328, -0.07092175,  0.25171137, -0.16049176,
        -0.1487034 ,  0.07078832, -0.10251026, -0.01468894,  0.28380013,
         0.02639887,  0.16564861, -0.09171878, -0.05002758, -0.21973127,
        -0.251331  , -0.23190457,  0.02526101, -0.19133468, -0.26591578,
        -0.09129952,  0.02355042, -0.07877165, -0.1745466 , -0.26074213,
         0.08911896,  0.20465702,  0.2049163 , -0.24429277]],
      dtype=float32)>), (None, <tf.Variable 'dense/bias:0' shape=(64,) dtype=float32, numpy=
array([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.], dtype=float32)>), (None, <tf.Variable 'dense_1/kernel:0' shape=(64, 64) dtype=float32, numpy=
array([[ 0.17547093,  0.06312855,  0.06420456, ...,  0.08145665,
        -0.20258653, -0.02345981],
       [-0.07690358, -0.09963293,  0.14336564, ...,  0.13114162,
        -0.00971529, -0.05480972],
       [ 0.12390189,  0.04099624, -0.20933919, ..., -0.12387034,
         0.09963654,  0.21482046],
       ...,
       [ 0.09011297,  0.12609254, -0.12851158, ..., -0.09188175,
        -0.05428408, -0.01993608],
       [ 0.09152506,  0.15742789, -0.12547606, ..., -0.18684775,
        -0.06524323,  0.18522985],
       [-0.14297488, -0.01011544,  0.12657808, ..., -0.05860677,
         0.08180766,  0.2148584 ]], dtype=float32)>), (None, <tf.Variable 'dense_1/bias:0' shape=(64,) dtype=float32, numpy=
array([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.], dtype=float32)>), (None, <tf.Variable 'dense_2/kernel:0' shape=(64, 1) dtype=float32, numpy=
array([[-0.02661058],
       [-0.29596284],
       [-0.01355371],
       [-0.02411991],
       [ 0.16088843],
       [-0.08878292],
       [ 0.2802301 ],
       [-0.1318938 ],
       [-0.1205762 ],
       [ 0.2713033 ],
       [-0.12036853],
       [ 0.02751729],
       [-0.20547122],
       [ 0.08678046],
       [ 0.04068026],
       [-0.01694027],
       [-0.05570742],
       [ 0.04988271],
       [-0.08485228],
       [ 0.17514282],
       [-0.25179467],
       [ 0.15269235],
       [-0.23303702],
       [-0.26212692],
       [-0.2123459 ],
       [ 0.08007064],
       [-0.22320062],
       [-0.22575808],
       [ 0.08629203],
       [-0.1371693 ],
       [ 0.00902489],
       [-0.30366027],
       [ 0.01938945],
       [-0.10523091],
       [ 0.08649623],
       [ 0.26832682],
       [-0.20719819],
       [-0.23190817],
       [-0.14438646],
       [-0.03121591],
       [-0.11606209],
       [ 0.21548903],
       [ 0.20200467],
       [-0.07250942],
       [ 0.16701514],
       [ 0.24037534],
       [ 0.2544558 ],
       [-0.12560998],
       [-0.20447275],
       [ 0.27143776],
       [-0.29260576],
       [-0.09748293],
       [-0.01332489],
       [-0.28306141],
       [ 0.00223577],
       [-0.01669326],
       [-0.01255453],
       [-0.01174518],
       [ 0.26531124],
       [-0.07353671],
       [ 0.18435669],
       [ 0.15208954],
       [ 0.29233313],
       [ 0.29090464]], dtype=float32)>), (None, <tf.Variable 'dense_2/bias:0' shape=(1,) dtype=float32, numpy=array([0.], dtype=float32)>)).
